<script>
function addPlayer(){
	$('#players').append(
		"<div class=\"col-sm-3 player-wrap\"><div class=\"player-in\"><h4>Player " + ($('.player').length+1) + "</h4><input class=\"form-control player\" type=\"text\" id=\"player-" + $('.player').length+ "\"><\/div><\/div>"
		);

};

function removePlayer(){

	if($('.player-wrap').length > 1){
		$('.player-wrap:last').remove();
	}
};


function compare(cat){

	var player_arr = [];

	var player_nodes = $('.player');

	for(var i = 0; i < player_nodes.length; i++){
		player_arr.push($('#player-'+ i).val());
	}


	$.ajax({
		             type: 'POST',
		             beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		             url: 'json_seasons_arr',
		             data: {
		                "players": player_arr,
		                "stat": cat
		             },
		             success:function(data) {
		             	console.log(data);
		             	new Chartkick.LineChart("chart-1", data);

		             	for(var i = 0; i< data.length; i++){
		             		$('#player-'+ i).val(data[i]['name']);
		             	}
	             	
		             },
		             err:function(err1) {
		              console.log(err);
		             }
		        });







	// var p1Input = $('#player-1').val();
	// var p2Input = $('#player-2').val();


      //   $.ajax({
      //        type: 'POST',
      //        beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
      //        url: 'json_seasons',
      //        data: {
      //           "player_name": p1Input
      //        },
      //        success:function(player1) {
      //        	console.log(player1['seasons']);

      //        	var data1 = {};
      //        	for(var i = 0; i<player1['seasons'].length; i++){
      //        		data1[player1['seasons'][i]["year"]] = player1['seasons'][i][cat];
      //        	}

      //        	$.ajax({
		    //          type: 'POST',
		    //          beforeSend: function(xhr) {xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'))},
		    //          url: 'json_seasons',
		    //          data: {
		    //             "player_name": p2Input
		    //          },
		    //          success:function(player2) {

		    //          	var data2 = {};
		    //          	for(var i = 0; i<player2['seasons'].length; i++){
		    //          		data2[player2['seasons'][i]["year"]] = player2['seasons'][i][cat];
		    //          	}

		    //          	$('#player-1').val(player1['name']);
		    //          	$('#player-2').val(player2['name']);

						// new Chartkick.LineChart("chart-1",[ {
				  //           "name": player1['name'],
				  //           "data": data1
				  //           },
				  //           {
				  //             "name": player2['name'],
				  //             "data": data2
				  //           }
				  //       ]);	
				  //       $('#graph-stat-1').val(cat);
	             	
		    //          },
		    //          err:function(err1) {
		    //           console.log(err);
		    //          }
		    //     });
      //        },
      //        err:function(err) {
      //         console.log(err);
      //        }
      //   });
      };

  function changeChart(){
  	 var stat = $('#graph-stat-1').val();
  	 compare(stat);
  };
  function loadPlayers(){
	compare('total_points');
  };
</script>




	<div id="actions" class="col-sm-12">
		<a id="compare" onclick="changeChart()" class="btn btn-primary btn-md left">Compare</a>
		
		<select name="chart-select" class="form-control" id="graph-stat-1" onchange="changeChart()"> 
		    <option value="total_points"><%=@stat_legend['total_points']%></option>
		    <% @graphable.each do |stat| %>
		    <option value="<%=stat%>"><%=@stat_legend[stat]%></option>
		    <% end %>
		 </select>
	</div>


	<div id="chart-1"></div>

	<div id="actions" class="col-sm-12">
				<a id="compare-add"onclick="addPlayer()" class="btn btn-success btn-md left">Add Player</a>
		<a id="compare-remove"onclick="removePlayer()" class="btn btn-danger btn-md left">Remove Player</a>
	</div>



	<div id='players'>

		<div class="col-sm-3 player-wrap">
			<div class="player-in">
				<h4 class='player-text'>Player 1</h4><input class="form-control tf-200 player" type="text" id="player-0">
			</div>
		</div>

		<div class="col-sm-3 player-wrap">
			<div class="player-in">
				<h4 class='player-text'>Player 2</h4><input class="form-control tf-200 player" type="text" id="player-1">
			</div>
		</div>

	</div>







